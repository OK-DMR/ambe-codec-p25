#include "mmdvm.h"
#include <oboe/Oboe.h>

extern "C"
JNIEXPORT jint JNI_OnLoad(JavaVM *vm, void *reserved) {
    return JNI_VERSION_1_6;
}

extern "C"
JNIEXPORT void JNICALL
Java_cz_okdmr_mmdvm_MainActivity_getNativeString(JNIEnv *env, jobject thiz) {
    if (!globalPlayer) {
        globalPlayer = new OboePlayer();
    }

    unsigned char voicedata[][9] = {
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {149, 75,  230, 80,  3,   16,  176, 7,   119},
            {182, 246, 235, 17,  48,  17,  139, 10,  125},
            {164, 228, 241, 127, 37,  179, 164, 165, 195},
            {38,  187, 219, 163, 83,  64,  18,  67,  56},
            {214, 184, 199, 113, 33,  101, 123, 141, 105},
            {79,  252, 167, 7,   86,  39,  142, 91,  39},
            {92,  238, 135, 33,  117, 65,  140, 40,  21},
            {89,  203, 162, 33,  117, 216, 138, 23,  251},
            {158, 148, 196, 2,   103, 43,  174, 194, 51},
            {237, 245, 129, 38,  1,   36,  30,  192, 173},
            {157, 150, 197, 38,  37,  126, 239, 161, 96},
            {199, 80,  27,  157, 84,  151, 171, 44,  44},
            {147, 22,  77,  16,  103, 107, 242, 109, 32},
            {91,  120, 56,  83,  96,  197, 124, 28,  32},
            {28,  44,  99,  29,  0,   245, 242, 185, 236},
            {104, 105, 23,  211, 86,  13,  251, 186, 164},
            {254, 231, 161, 85,  52,  51,  111, 130, 186},
            {62,  199, 90,  142, 64,  197, 151, 115, 120},
            {94,  79,  51,  181, 48,  196, 250, 240, 124},
            {29,  60,  64,  91,  32,  231, 243, 188, 236},
            {59,  27,  101, 88,  84,  43,  178, 180, 117},
            {125, 58,  5,   119, 102, 165, 161, 84,  160},
            {9,   124, 111, 61,  18,  242, 72,  195, 60},
            {76,  111, 226, 81,  82,  30,  145, 176, 212},
            {230, 58,  128, 112, 50,  126, 37,  37,  219},
            {196, 11,  160, 48,  119, 15,  1,   18,  202},
            {197, 8,   130, 80,  82,  126, 53,  21,  234},
            {58,  83,  194, 23,  83,  56,  175, 25,  103},
            {91,  2,   133, 119, 81,  118, 40,  73,  138},
            {161, 21,  128, 117, 16,  15,  91,  136, 46},
            {210, 68,  199, 117, 21,  49,  255, 204, 231},
            {61,  100, 239, 46,  21,  39,  130, 205, 35},
            {215, 139, 229, 116, 117, 16,  95,  143, 75},
            {196, 138, 229, 80,  19,  39,  94,  202, 121},
            {25,  225, 165, 97,  64,  68,  183, 181, 212},
            {57,  193, 133, 3,   1,   98,  179, 209, 214},
            {32,  247, 137, 28,  119, 115, 6,   148, 25},
            {207, 198, 131, 119, 85,  113, 106, 240, 191},
            {221, 214, 131, 119, 113, 70,  24,  194, 171},
            {232, 40,  161, 113, 33,  37,  174, 199, 35},
            {141, 22,  163, 55,  64,  98,  130, 57,  183},
            {211, 103, 229, 51,  50,  49,  143, 238, 209},
            {49,  174, 227, 21,  49,  23,  245, 202, 81},
            {204, 199, 131, 84,  48,  19,  14,  212, 158},
            {205, 246, 131, 54,  53,  18,  11,  193, 188},
            {248, 57,  131, 37,  3,   19,  206, 215, 118},
            {219, 8,   163, 35,  50,  19,  142, 177, 21},
            {149, 73,  199, 85,  85,  7,   215, 64,  85},
            {63,  140, 192, 80,  5,   57,  40,  91,  141},
            {93,  236, 167, 20,  0,   19,  203, 57,  103},
            {162, 151, 231, 23,  52,  81,  4,   20,  217},
            {146, 148, 199, 119, 16,  118, 87,  4,   137},
            {227, 212, 130, 70,  19,  56,  128, 2,   19},
            {247, 224, 164, 66,  49,  210, 243, 24,  174},
            {173, 92,  227, 71,  54,  214, 72,  140, 5},
            {172, 36,  56,  248, 109, 176, 52,  120, 154},
            {240, 237, 44,  125, 189, 31,  30,  92,  234},
            {233, 3,   111, 111, 129, 223, 130, 69,  196},
            {200, 65,  127, 33,  121, 25,  26,  40,  196},
            {231, 201, 103, 159, 145, 211, 122, 105, 156},
            {183, 169, 116, 119, 191, 25,  210, 143, 64},
            {231, 232, 34,  23,  201, 50,  70,  173, 217},
            {215, 201, 32,  82,  250, 2,   86,  157, 235},
            {245, 233, 67,  97,  178, 138, 210, 97,  228},
            {179, 175, 33,  66,  247, 47,  82,  29,  163},
            {195, 166, 39,  49,  160, 197, 73,  188, 191},
            {164, 242, 100, 80,  180, 32,  154, 241, 220},
            {199, 164, 3,   37,  11,  149, 48,  21,  230},
            {166, 31,  96,  17,  92,  116, 67,  27,  61},
            {167, 15,  32,  82,  20,  170, 150, 166, 54},
            {179, 41,  15,  56,  37,  226, 136, 2,   37},
            {250, 66,  195, 2,   37,  130, 64,  1,   131},
            {201, 115, 88,  138, 111, 117, 144, 101, 142},
            {234, 5,   109, 74,  15,  21,  238, 132, 81},
            {153, 71,  79,  176, 83,  253, 82,  100, 137},
            {227, 203, 121, 181, 59,  117, 106, 41,  94},
            {193, 175, 64,  211, 91,  157, 198, 12,  84},
            {193, 173, 71,  63,  9,   209, 90,  1,   73},
            {163, 206, 39,  212, 93,  151, 70,  104, 239},
            {134, 251, 44,  3,   60,  240, 198, 165, 160},
            {193, 173, 79,  0,   126, 81,  68,  248, 231},
            {135, 160, 108, 21,  121, 82,  15,  49,  55},
            {165, 147, 13,  23,  32,  189, 206, 152, 8},
            {193, 141, 227, 119, 83,  191, 45,  165, 148},
            {255, 71,  96,  108, 79,  17,  18,  233, 196},
            {194, 158, 45,  83,  81,  157, 194, 36,  221},
            {225, 173, 45,  112, 116, 249, 130, 21,  238},
            {195, 201, 10,  163, 69,  159, 217, 240, 103},
            {241, 232, 40,  164, 69,  158, 200, 224, 81},
            {164, 199, 40,  209, 39,  153, 194, 108, 229},
            {131, 253, 164, 118, 54,  215, 158, 196, 28},
            {128, 239, 165, 116, 52,  181, 222, 199, 28},
            {203, 65,  56,  153, 37,  153, 23,  205, 196},
            {233, 37,  41,  231, 37,  145, 215, 97,  16},
            {195, 175, 28,  54,  83,  157, 194, 5,   249},
            {129, 237, 73,  1,   116, 245, 66,  36,  96},
            {160, 239, 107, 103, 101, 243, 16,  20,  70},
            {129, 171, 77,  135, 38,  227, 92,  179, 142},
            {179, 139, 108, 214, 116, 245, 94,  128, 172},
            {205, 71,  199, 35,  20,  91,  35,  28,  122},
            {217, 67,  192, 33,  81,  181, 65,  0,   192},
            {204, 101, 197, 32,  33,  125, 98,  73,  92},
            {161, 253, 135, 2,   53,  177, 140, 197, 8},
            {203, 67,  120, 174, 41,  2,   228, 113, 207},
            {171, 101, 78,  224, 39,  170, 71,  17,  206},
            {217, 7,   42,  224, 65,  183, 241, 68,  116},
            {202, 37,  40,  194, 5,   179, 130, 20,  38},
            {220, 54,  30,  192, 234, 242, 223, 171, 8},
            {201, 115, 111, 37,  15,  92,  59,  13,  166},
            {205, 3,   96,  37,  126, 94,  194, 32,  32},
            {205, 1,   98,  7,   90,  92,  160, 19,  32},
            {219, 68,  70,  77,  226, 64,  104, 39,  249},
            {175, 1,   5,   13,  167, 209, 222, 59,  168},
            {251, 34,  119, 97,  229, 77,  152, 189, 89},
            {207, 7,   99,  1,   178, 227, 222, 240, 132},
            {139, 66,  2,   33,  214, 3,   29,  216, 231},
            {136, 97,  0,   35,  215, 2,   15,  156, 198},
            {251, 33,  69,  7,   181, 59,  152, 186, 105},
            {138, 65,  34,  103, 244, 22,  8,   185, 226},
            {138, 82,  3,   7,   134, 54,  12,  187, 181},
            {235, 34,  100, 2,   148, 111, 143, 156, 123},
            {203, 3,   70,  98,  230, 125, 152, 185, 72},
            {181, 168, 37,  85,  160, 214, 22,  113, 95},
            {215, 232, 66,  84,  226, 140, 211, 81,  193},
            {161, 170, 33,  66,  56,  134, 8,   184, 115},
            {196, 149, 32,  21,  26,  194, 67,  80,  150},
            {179, 243, 90,  63,  62,  240, 220, 210, 60},
            {167, 247, 10,  244, 64,  238, 214, 29,  192},
            {227, 201, 9,   167, 36,  157, 206, 231, 98},
            {205, 33,  38,  205, 51,  173, 220, 209, 96},
            {239, 1,   39,  175, 84,  159, 207, 246, 96},
            {139, 33,  122, 99,  48,  253, 88,  212, 114},
            {137, 1,   88,  99,  18,  254, 11,  215, 66},
            {174, 97,  86,  7,   119, 175, 197, 222, 228},
            {255, 35,  52,  137, 50,  187, 207, 212, 98},
            {170, 3,   90,  71,  32,  216, 88,  245, 64},
            {171, 2,   91,  70,  48,  218, 91,  213, 115},
            {171, 19,  123, 100, 5,   237, 72,  240, 96},
            {161, 139, 56,  89,  40,  18,  70,  33,  218},
            {163, 170, 26,  88,  10,  16,  22,  32,  249},
            {128, 139, 122, 77,  3,   253, 144, 187, 228},
            {225, 201, 10,  164, 82,  170, 202, 242, 100},
            {192, 157, 43,  200, 38,  179, 12,  61,  134},
            {162, 221, 132, 86,  114, 215, 140, 192, 40},
            {155, 1,   95,  200, 71,  177, 211, 153, 46},
            {162, 137, 127, 183, 52,  231, 78,  182, 136},
            {144, 154, 106, 92,  18,  253, 147, 139, 213},
            {225, 233, 47,  94,  101, 161, 71,  220, 122},
            {192, 251, 46,  45,  48,  167, 84,  238, 106},
            {136, 87,  74,  41,  85,  199, 173, 94,  160},
            {237, 71,  198, 17,  116, 89,  2,   73,  104},
            {236, 87,  228, 65,  54,  59,  1,   120, 74},
            {139, 35,  126, 169, 22,  227, 212, 184, 62},
            {234, 37,  56,  164, 117, 181, 196, 119, 32},
            {171, 87,  104, 110, 6,   245, 154, 75,  130},
            {194, 203, 44,  126, 4,   177, 70,  204, 106},
            {199, 237, 41,  41,  86,  57,  18,  182, 166},
            {180, 159, 107, 164, 22,  59,  24,  157, 4},
            {135, 251, 162, 102, 16,  61,  202, 223, 128},
            {238, 85,  198, 32,  49,  27,  96,  106, 110},
            {186, 16,  231, 64,  29,  19,  55,  204, 38},
            {91,  204, 225, 113, 245, 170, 33,  79,  64},
            {34,  172, 219, 123, 5,   199, 248, 102, 169},
            {127, 204, 228, 17,  61,  250, 15,  165, 123},
            {198, 227, 133, 83,  87,  240, 134, 90,  255},
            {104, 203, 161, 52,  117, 239, 233, 85,  207},
            {106, 250, 224, 20,  61,  38,  124, 175, 165},
            {238, 29,  165, 65,  19,  252, 174, 155, 153},
            {168, 1,   166, 21,  49,  189, 129, 6,   79},
            {197, 143, 28,  252, 255, 179, 115, 160, 168},
            {230, 235, 2,   21,  155, 20,  98,  190, 218},
            {232, 19,  103, 5,   166, 24,  255, 159, 111},
            {234, 33,  71,  54,  177, 8,   255, 156, 94},
            {172, 121, 101, 40,  183, 23,  87,  143, 62},
            {236, 74,  34,  71,  93,  141, 110, 230, 183},
            {172, 107, 68,  126, 149, 1,   115, 223, 9},
            {203, 111, 7,   23,  123, 20,  111, 217, 94},
            {138, 45,  66,  49,  121, 109, 232, 251, 198},
            {239, 88,  108, 183, 114, 218, 79,  217, 14},
            {172, 11,  8,   212, 84,  135, 219, 137, 246},
            {140, 8,   9,   167, 113, 164, 159, 221, 246},
            {142, 167, 197, 48,  81,  91,  156, 182, 16},
            {170, 131, 224, 23,  16,  163, 170, 140, 223},
            {157, 167, 199, 23,  21,  88,  158, 128, 33},
            {206, 68,  197, 16,  101, 88,  70,  122, 127},
            {171, 35,  31,  168, 75,  121, 99,  33,  66},
            {142, 5,   39,  8,   9,   125, 166, 238, 26},
            {238, 71,  66,  15,  43,  117, 118, 190, 210},
            {238, 69,  66,  57,  73,  85,  51,  204, 210},
            {204, 15,  91,  38,  71,  217, 2,   122, 178},
            {200, 43,  96,  195, 37,  173, 247, 163, 187},
            {200, 41,  96,  199, 118, 253, 243, 147, 143},
            {205, 107, 110, 210, 115, 249, 94,  169, 8},
            {168, 71,  92,  167, 87,  152, 86,  38,  234},
            {250, 65,  45,  5,   81,  243, 191, 179, 155},
            {200, 37,  43,  146, 102, 177, 161, 80,  6},
            {154, 75,  231, 38,  100, 61,  127, 199, 188},
            {76,  99,  128, 29,  35,  183, 158, 154, 176},
            {184, 179, 226, 70,  54,  146, 203, 155, 152},
            {143, 167, 199, 0,   85,  104, 202, 163, 4},
            {191, 165, 230, 2,   80,  73,  187, 128, 2},
            {174, 4,   121, 175, 113, 92,  150, 146, 245},
            {201, 7,   10,  193, 112, 209, 134, 115, 50},
            {202, 37,  41,  163, 81,  209, 163, 64,  22},
            {204, 101, 229, 18,  5,   91,  97,  124, 108},
            {204, 71,  197, 81,  20,  93,  66,  88,  90},
            {201, 99,  194, 119, 55,  181, 85,  23,  178},
            {228, 41,  163, 97,  6,   125, 39,  2,   221},
            {228, 59,  161, 67,  34,  109, 117, 16,  220},
            {140, 133, 196, 19,  53,  94,  158, 147, 6},
            {12,  45,  129, 218, 65,  107, 235, 152, 98},
            {142, 181, 196, 51,  112, 121, 170, 179, 20},
            {223, 101, 196, 114, 96,  89,  80,  77,  92},
            {252, 117, 231, 52,  37,  31,  66,  124, 127},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
            {185, 232, 129, 82,  97,  115, 0,   42,  107},
    };

    for (auto &i: voicedata) {
        globalPlayer->addAmbeSamples(i);
    }

    auto prepareAudioResult = globalPlayer->prepareAudio();
    __android_log_print(ANDROID_LOG_WARN, "mmdvm.cpp", "prepareAudio %d", prepareAudioResult);
    auto startAudioResult = globalPlayer->startAudio();
    __android_log_print(ANDROID_LOG_WARN, "mmdvm.cpp", "startAudio %d", startAudioResult);
}